数据集是从Github开源项目fork，该项目爬取了丁香园从北京时间2020/1/27至2020/3/30 18：32：13的全球疫情累计数据，每次统计间隔大约半小时。

首先，我想要分析的是美国和意大利疫情感染情况，在数据预处理过程中通过聚合函数保留了数据集中的累计确诊、累计治愈、累计死亡和每日新增确诊四项指标，绘图结果展示如下：

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image001.png)

**图1. 美国疫情发展数据图**

先以对美国的各项指标建模和预测过程为例，通过可视化视图不难发现，累计确诊、累计治愈、累计死亡三项指标属于非平稳时间序列，具有明显趋势性，需要采用指数平滑模型来分析，每日确诊数相对而言更加平稳，可以考虑差分后作为平稳时间序列进行分析，因此在经过数据探索后我决定先对每日新增确诊病例做平稳性时间序列分析。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image004.png)

**图2.美国每日新增确诊病例**

由于2-20之前各项数据基本保持在0，对后续时间序列参考价值不大，这里只截取2-20之后的数据进行拟合，daily_confirm的数据具有非平稳趋势性的同时也存在波动性，适合用ARIMA模型分析。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image006.png)

**图3.美国每日新增确诊病例一阶差分**

对数据进行一阶差分后可以看到基本剔除了趋势属性，差分数据为平稳时间序列，进一步通过自相关图和偏自相关图寻找ARMA模型合适的自相关系数和偏自相关系数。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image008.png)

**图4.自相关和偏自相关图**

观察两图得知：自相关图1阶截尾，偏自相关图在滞后17阶后偏自相关图超出置信边界。选模型有：

ARMA（0，1）：q=1的移动平均模型；

ARMA（0，2）：q=2的移动平均模型；

ARMA（1，0）：p=1的自相关模型。

​    根据AIC准则对备选模型评估，最后选择ARMA（0，2）。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image010.png)

**图5. ARMA（0，2）模型预测图**

由于平稳时间序列波动性影响因素较多，不适合做长期预测，只预测之后两天的每日确诊情况，差分还原后模型预测3-31每日确诊18495例，4-1每日确诊18942例。

对于非平稳时间序列，首先采用季节性分析分离数据的各项趋势。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image012.png)

**图6. 累计确诊数据趋势分离图**

可以看到，累计确诊数据几乎没有季节等特征，只之表现出趋势性特征。于是采用Holt指数模型研究该指标的趋势性。分别采用Holt指数平滑线性模型和指数模型来对数据进行拟合。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image014.png)

**图7.Holt对确诊数拟合效果对比**

从RMSE角度来看，模型2和模型4 RMSE值最低，拟合效果最好。

模型2认为，美国累计确诊在3-31将达到160057例，4-1达到179315例，4-2达到198573例，并预计4-9达到40万例左右。

模型4认为，美国累计确诊在3-31将达到175718例，4-1达到207718例，4-2达到245547例，并预计4-9达到80万例左右。

截至2020/4/2，美国实际确诊情况：3-31：186265例，4-1：213372例，4-2:242182例。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image016.png)

**图8. 累计治愈数据趋势分离图**

可以看到，累计治愈数据几乎没有季节等特征，只之表现出趋势性特征。于是采用Holt指数模型研究该指标的趋势性。分别采用Holt指数平滑线性模型和指数模型来对数据进行拟合。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image018.png)

**图9. Holt对治愈数拟合效果对比**

从RMSE角度来看，模型4的RMSE值最低，拟合效果最好。

模型1认为，美国累计治愈在3-31将达到4783例，4-1达到5956例，4-2达到7130例，4-9达到15344例；

模型2认为，美国累计治愈在3-31将达到4376例，4-1达到5521例，4-2达到6665例，并预计4-9达到14679例；

模型3认为，美国累计治愈在3-31将达到5977例，4-1达到8694例，4-2达到12644例，并预计4-9达到174061例；

模型4认为，美国累计治愈在3-31将达到6784例，4-1达到10683例，4-2达到16822例，并预计4-9达到403822例；

截至2020/4/3，美国累计治愈情况：3-31：7109例，4-1：8434例，4-2：9058例。经过实际值对比认为，治愈数累计情况在当前适合用Holt指数模型拟合，在达到一定数量后需要分段，对后续数据采取Holt线性模型进行拟合更能符合实际情况，分段点位置需要根据美国疫情发展的实际情况决定。

 

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image019.png)

​		**图10. 累计死亡数据趋势分离图**

可以看到，累计死亡数据几乎没有季节等特征，只之表现出趋势性特征。于是采用Holt指数模型研究该指标的趋势性。分别采用Holt指数平滑线性模型和指数模型来对数据进行拟合。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image021.png)

**图11. 累计死亡数据趋势分离图**

从RMSE角度来看，模型2,3的RMSE值最低，拟合效果最好。

模型1认为，美国累计死亡在3-31将达到3725例，4-1达到4615例，4-2达到5716例，并预计4-9达到25583例

模型2认为，美国累计死亡在3-31将达到3363例，4-1达到4187例，4-2达到5212例，并预计4-9达到24168例

模型3认为，美国累计死亡在3-31将达到3335例，4-1达到4160例，4-2达到5189例，并预计4-9达到24384例

截至2020/4/3，美国累计死亡情况：3-31：3810例，4-1：4757例，4-2日：5850例

疫情爆发初期无法控制,死亡人数野蛮增长，Holt指数模型更能从死亡人数上刻画疫情的真实性。后期随着防疫工作开展，疫情将逐渐得到控制，增速放缓，更适合用Holt线性模型，因此不同阶段的时间序列需要分段预测，同样，目前的疫情发展情况表明爆发速度放缓的转折点还未达到。

由于意大利疫情爆发情况与美国类似，基本采用了相似的模型和分析方法，这里只介绍主要结果和一些分析过程中和美国表现不同的地方。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image023.png)

**图12. 意大利疫情发展数据图**

首先，同样是对每日新增确诊病例的数据分析，经过一阶差分后可以看到每日确诊病例呈现平稳时间序列的特点。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image025.png)

**图13.意大利每日新增确诊病例一阶差分**

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image027.png)

**图14.自相关和偏自相关图**

观察两图得知：自相关图1阶截尾，偏自相关图在滞后23阶后超出置信边界。选模型有：

ARMA（0，1）：q=1的移动平均模型；

ARMA（1，0）：p=1的自相关模型。

​    根据AIC准则对备选模型评估，最后选择AIC得分更小ARMA（0，1）。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image029.png)

**图15. ARMA（0，1）模型预测图**

绘制的一阶差分结果如图所示，模型与实际差分情况拟合度较好，可以用来预测。由于平稳时间序列波动性影响因素较多，不适合做长期预测，只预测之后两天的每日确诊情况，差分还原后模型预测意大利3-31每日新增确诊5978例，4-1每日确诊7317例。

截至4-3，3-31每日确诊4053例，4-1每日确诊4758例，实际情况比原有模型预估结果要少，说明意大利疫情蔓延已经得到初步缓解或时间上已经到达了爆发阶段的拐点。

对于累计确诊、累计治愈和累计病例同样采用了Holt指数平滑法进行分析，首先是对累计确诊情况的分析。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image031.png)

​														**图16.Holt对确诊数拟合效果对比**

从RMSE角度来看，模型1和模型2的RMSE值拟合效果最好。

模型1认为，意大利累计确诊在3-31：103186例，4-1：108544例，4-2：113920例，4-9：151409例。

模型2认为，意大利累计确诊在3-31：103702例，4-1：109286例，4-2：114870例，4-9：153958例。

截至2020/4/3，意大利实际确诊情况：3-31：105792例，4-1：110574例，4-2:115716例。

接着是对累计治愈病例分析。

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image033.png)

​														**图17.Holt对累计治愈拟合效果对比**

从RMSE角度来看，模型1和模型2的RMSE值拟合效果最好。

模型1认为，意大利累计治愈在3-31： 14040例，4-1：15010例，4-2：15980例，4-9：22767例。

模型2认为，意大利累计治愈在3-31：14020例，4-1：14989例，4-2：15989例，4-9：22741例。

模型3认为，意大利累计治愈在3-31：17144例，4-1：20113例，4-2：23596例，4-9：72170例。

模型4认为，意大利累计治愈在3-31：15110例，4-1：16764例，4-2：18599例，4-9：38478例。

截至2020/4/3，意大利实际治愈情况：3-31：14620例，4-1：16847例，4-2:18278例结合疫情实际不难发现，模型4最符合疫情发展情况。

最后是对累计死亡病例分析：

![img](https://github.com/yangchaofan3/projects/blob/master/Covid-19/pictures/clip_image035.png)

​															**图18. 累计死亡数据趋势分离图**

根据均方根误差，模型2拟合效果最好。

模型1认为，意大利累计死亡在3-31：12354例，4-1：13505例，4-2：14763例，4-9达到27539例

模型2认为，意大利累计死亡在3-31：11613例，4-1：12450例，4-2：13287例，4-9达到19149例

模型3认为，意大利累计死亡在3-31：11920例，4-1：12979例，4-2：13132例，4-9达到25641例

截至2020/4/3，意大利实际治愈情况：3-31：12428例，4-1：13155例，4-2:13915例，模型3最符合当前疫情发展情况。

后续随着防疫工作进一步开展，死亡病例发展态势将得到控制，疫情转折点之后采用线性模型预测更合适。
